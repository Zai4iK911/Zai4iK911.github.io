<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        body {text-align: center;}
    </style>
</head>
<body>
    <div id="currentNumberContainer">
        <h1>Current Number: <span id="currentNumberValue"></span></h1>
        <button id="increase">+1</button>
        <button id="decrease">-1</button>
    </div>

    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js";

        // Your web app's Firebase configuration
  const firebaseConfig = {
    apiKey: "AIzaSyAI8WPAAx-siQpG42ewRIi4OorICr9QG9M",
    authDomain: "test-e92a1.firebaseapp.com",
    databaseURL: "https://test-e92a1-default-rtdb.europe-west1.firebasedatabase.app",
    projectId: "test-e92a1",
    storageBucket: "test-e92a1.appspot.com",
    messagingSenderId: "521289994282",
    appId: "1:521289994282:web:5bc103711a2b03ed827353"
  };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);

        import { getDatabase, ref, get, child, runTransaction } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-database.js";

        const db = getDatabase();
        var currentNumberValue = document.querySelector("#currentNumberValue");
        var increaseBtn = document.querySelector("#increase");
        var decreaseBtn = document.querySelector("#decrease");

        function DisplayCurrentNumber() {
            const dbref = ref(db);

            get(child(dbref, "currentNumber"))
            .then((snapshot) => {
                if (snapshot.exists()) {
                    const currentNumber = snapshot.val();
                    if (typeof currentNumber === 'number') {
                        currentNumberValue.textContent = currentNumber;
                    } else {
                        currentNumberValue.textContent = "Invalid data";
                    }
                } else {
                    currentNumberValue.textContent = "N/A";
                }
            })
            .catch((error) => {
                console.error(error);
                currentNumberValue.textContent = "Error";
            });
        }

        function updateCurrentNumber(increment) {
            const currentNumberRef = ref(db, "currentNumber");
            runTransaction(currentNumberRef, (currentNumber) => {
                if (currentNumber === null) {
                    return 0;
                }
                return currentNumber + increment;
            })
            .then(() => {
                DisplayCurrentNumber();
            })
            .catch((error) => {
                console.error(error);
            });
        }

        increaseBtn.addEventListener('click', () => {
            updateCurrentNumber(1);
        });

        decreaseBtn.addEventListener('click', () => {
            updateCurrentNumber(-1);
        });

        // Вызовите функцию для отображения значения currentNumber при загрузке страницы
        DisplayCurrentNumber();
    </script>
</body>
</html>
